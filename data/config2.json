{
  "cleans": [
    {
      "name": "state",
      "func": "function clean(d) {\n    return  d['STABBR'] || 0\n}",
      "editLink": "<button cid='state' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='state' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "control",
      "func": "function clean(d) {\n    return  d['CONTROL'] || 0\n}",
      "editLink": "<button cid='control' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='control' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "instsize",
      "func": "function clean(d) {\n    return  d['INSTSIZE'] || 0\n}",
      "editLink": "<button cid='instsize' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='instsize' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "iclevel",
      "func": "function clean(d) {\n    return  d['ICLEVEL'] || 0\n}",
      "editLink": "<button cid='iclevel' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='iclevel' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "year",
      "func": "function clean(d) {\n    return  d['YEAR'] || 0\n}",
      "editLink": "<button cid='year' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='year' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "enrolled",
      "func": "function clean(d) {\n    return  d['EFDETOT__All'] || 0\n}",
      "editLink": "<button cid='enrolled' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='enrolled' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "collegetype",
      "func": "function clean(d) {\n    return  d['C15RECODE'] || 0\n}",
      "editLink": "<button cid='collegetype' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='collegetype' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "carnegie",
      "func": "function clean(d) {\n    return  d['CARNEGIE'] || 0\n}",
      "editLink": "<button cid='carnegie' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='carnegie' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "oncampusall",
      "func": "function clean(d) {\n    return  d['EFONCAMPUS__All'] || 0\n}",
      "editLink": "<button cid='oncampusall' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='oncampusall' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "oncampusdegree",
      "func": "function clean(d) {\n    return  d['EFONCAMPUS__Degree'] || 0\n}",
      "editLink": "<button cid='oncampusdegree' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='oncampusdegree' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "oncampusgrad",
      "func": "function clean(d) {\n    return  d['EFONCAMPUS__Grad'] || 0\n}",
      "editLink": "<button cid='oncampusgrad' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='oncampusgrad' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "oncampusnon",
      "func": "function clean(d) {\n    return  d['EFONCAMPUS__Non'] || 0\n}",
      "editLink": "<button cid='oncampusnon' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='oncampusnon' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "oncampusunder",
      "func": "function clean(d) {\n    return  d['EFONCAMPUS__Under'] || 0\n}",
      "editLink": "<button cid='oncampusunder' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='oncampusunder' class='cleanRemoveButton' role='button'>Remove</button>"
    }
  ],
  "dims": [
    {
      "name": "controlDim",
      "func": "function getDim(d) {\n    return d['control'];\n}",
      "editLink": "<button did='controlDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='controlDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "levelDim",
      "func": "function getDim(d) {\n    return d['iclevel'];\n}",
      "editLink": "<button did='levelDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='levelDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "sizeDim",
      "func": "function getDim(d) {\n    return d['instsize'];\n}",
      "editLink": "<button did='sizeDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='sizeDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "stateDim",
      "func": "function getDim(d) {\n    return d['state'];\n}",
      "editLink": "<button did='stateDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='stateDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "yearDim",
      "func": "function getDim(d) {\n    return d['year'];\n}",
      "editLink": "<button did='yearDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='yearDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "noDim",
      "func": "function getDim(d) {\n    return 1;\n}",
      "editLink": "<button did='noDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='noDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "carnegieDim",
      "func": "function getDim(d) {\n    return d['carnegie'];\n}",
      "editLink": "<button did='carnegieDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='carnegieDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "collegeTypeDim",
      "func": "function getDim(d) {\n    return d['collegetype'];\n}",
      "editLink": "<button did='collegeTypeDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='collegeTypeDim' class='dimRemoveButton' role='button'>Remove</button>"
    }
  ],
  "grps": [
    {
      "name": "count",
      "func": "function getGrp(d) {\n    return d['columnName'];\n}",
      "aggs": [
        "count"
      ],
      "editLink": "<button gid='count' class='groupEditButton' role='button'>Edit</button>",
      "removeLink": "<button gid='count' class='groupRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "enrolled",
      "func": "function getGrp(d) {\n    return +d['enrolled'];\n}",
      "aggs": [
        "count",
        "sum",
        "avg"
      ],
      "editLink": "<button gid='enrolled' class='groupEditButton' role='button'>Edit</button>",
      "removeLink": "<button gid='enrolled' class='groupRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "test",
      "func": "function getGrp(d) {\n    return d['columnName'];\n}",
      "aggs": [
        "test"
      ],
      "editLink": "<button gid='test' class='groupEditButton' role='button'>Edit</button>",
      "removeLink": "<button gid='test' class='groupRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "enrolledChange",
      "extraName": "orig",
      "func": "function getGrp(d) {\n    if (d.year == '2012') {\n        return -d.enrolled; \n    } else if (d.year == '2017') {\n        return +d.enrolled;\n    } else {\n        return 0;\n    }\n}",
      "extraFunc": "function getGrp(d) {\n    if (d.year == '2012') {\n        return +d.enrolled; \n    } else {\n        return 0;\n    }\n}",
      "aggs": [
        "sum"
      ],
      "extraAggs": [
        "sum"
      ],
      "editLink": "<button gid='enrolledChange' class='groupEditButton' role='button'>Edit</button>",
      "removeLink": "<button gid='enrolledChange' class='groupRemoveButton' role='button'>Remove</button>"
    }
  ],
  "charts": [
    {
      "name": "controlSelector",
      "dim": "controlDim",
      "grp": "count",
      "chartType": "cboxMenu",
      "width": "3",
      "height": "",
      "heading": "",
      "options": {
        "controlsUseVisibility": "",
        "multiple": "",
        "valueAccessor": "function (d) { return d.value.count }",
        "keyAccessor": "function (d) { return d.key }"
      }
    },
    {
      "name": "sizeSelector",
      "dim": "sizeDim",
      "grp": "count",
      "chartType": "cboxMenu",
      "width": "3",
      "height": "",
      "heading": "",
      "options": {
        "controlsUseVisibility": "",
        "multiple": "",
        "valueAccessor": "function (d) { return d.value.count }",
        "keyAccessor": "function (d) { return d.key }"
      }
    },
    {
      "name": "headText",
      "dim": "controlDim",
      "grp": "count",
      "chartType": "html",
      "width": "8",
      "height": "",
      "heading": "",
      "options": {
        "html": "Just choose a filter on the right and start slicin' and dicin'. Enjoy!"
      }
    },
    {
      "name": "levelSelector",
      "dim": "levelDim",
      "grp": "count",
      "chartType": "cboxMenu",
      "width": "4",
      "height": "",
      "heading": "",
      "options": {
        "controlsUseVisibility": "",
        "multiple": "",
        "valueAccessor": "function (d) { return d.value.count }"
      }
    },
    {
      "name": "stateMap",
      "dim": "stateDim",
      "grp": "enrolledChange",
      "chartType": "geoChoroplethChart",
      "width": "8",
      "height": "500",
      "heading": "Percent Change of Enrollment from 2012 to 2018 by state",
      "options": {
        "valueAccessor": "function (d) { \nif (d.value && d.value.sum && d.value.orig && d.value.orig.sum) {\n    return d.value.sum / d.value.orig.sum\n} else {\n    return 0\n}\n}",
        "colors": "d3.scaleQuantize().range(\nd3.schemeReds[6].map(function(d,i) { return d3.format(\"0=3\")(i).toString() + d}).reverse().map(function(d) { return d.substr(3,7) }).concat(d3.schemeGreens[6])\n);",
        "colorDomain": "[-.15, .15]",
        "colorCalculator": "function (d) { return d ? chart.colors()(d) : '#ccc'; }",
        "GEO": "usstates"
      }
    },
    {
      "name": "enrolledOverTime",
      "dim": "yearDim",
      "grp": "enrolled",
      "chartType": "barChart",
      "width": "4",
      "height": "200",
      "heading": "Enrolled Students over Time",
      "options": {
        "centerBar": "true",
        "xAxis": {
          "ticks": "5",
          "tickFormat": "d3.format('.4')"
        },
        "x": "d3.scaleLinear().domain([2011,2018])",
        "valueAccessor": "function (d) { return d.value.sum }",
        "keyAccessor": "function (d) { return d.key }",
        "elasticY": "1",
        "yAxis": {
          "tickFormat": "d3.format('.2s')",
          "ticks": "3"
        }
      }
    },
    {
      "name": "enrolledOverTime2",
      "dim": "yearDim",
      "grp": "enrolled",
      "chartType": "barChart",
      "width": "4",
      "height": "200",
      "heading": "Difference of Enrolled Students from year to year",
      "options": {
        "centerBar": "true",
        "xAxis": {
          "ticks": "5",
          "tickFormat": "d3.format('.4')"
        },
        "x": "d3.scaleLinear().domain([2011,2018])",
        "valueAccessor": "function (d) { \n    var _year = d.key\n    if (+_year > 2012) {\n        var prev_value = grp\n           .all()\n           .filter(function(d) { \n               return d.key == (+_year-1).toString() \n           })[0].value.sum\n           \n        return d.value.sum - prev_value           \n    } else {\n        return 0;\n    }\n    //return d.value.sum \n    \n}",
        "keyAccessor": "function (d) { return d.key }",
        "elasticY": "1",
        "yAxis": {
          "tickFormat": "d3.format('.2s')",
          "ticks": "3"
        }
      }
    },
    {
      "name": "enrolledOverTime3",
      "dim": "yearDim",
      "grp": "enrolled",
      "chartType": "barChart",
      "width": "4",
      "height": "200",
      "heading": "Percent Difference of Enrolled Students from year to year",
      "options": {
        "centerBar": "true",
        "xAxis": {
          "ticks": "5",
          "tickFormat": "d3.format('.4')"
        },
        "x": "d3.scaleLinear().domain([2011,2018])",
        "valueAccessor": "function (d) { \n    var _year = d.key\n    if (+_year > 2012) {\n        var prev_value = grp\n           .all()\n           .filter(function(d) { \n               return d.key == (+_year-1).toString() \n           })[0].value.sum;\n        \n        return (d.value.sum - prev_value) / d.value.sum\n\n    } else {\n        return 0\n    }\n    //return d.value.sum \n}",
        "keyAccessor": "function (d) { return d.key }",
        "elasticY": "1",
        "yAxis": {
          "tickFormat": "d3.format('.1')",
          "ticks": "3"
        }
      }
    },
    {
      "name": "collegetypeSelector",
      "dim": "collegeTypeDim",
      "grp": "count",
      "chartType": "cboxMenu",
      "width": "3",
      "height": "",
      "heading": "",
      "options": {
        "controlsUseVisibility": "",
        "multiple": "",
        "valueAccessor": "function (d) { return d.value.count }"
      }
    }
  ],
  "style": "#graphContainer {\n    width : 850px;\n}\n#chart_sizeSelector {\n    position:absolute;\n    top:200px;\n    left:820px;\n}\n#chart_controlSelector {\n    position:absolute;\n    left:820px;\n}\n#chart_levelSelector {\n    position:absolute;\n    top:450px;\n    left:820px;\n}\n#chart_collegetypeSelector {\n    position:absolute;\n    top:600px;\n    left:820px;\n}\n\n#chart_sizeSelector .dc-cbox-group,\n#chart_levelSelector .dc-cbox-group,\n#chart_collegetypeSelector .dc-cbox-group,\n#chart_controlSelector .dc-cbox-group{\n    list-style: none;\n    padding:0px;\n}\n.dc-cbox-group li label {\n    padding-left: 10px;\n}",
  "filter": "function (d) {\n  var c1 = +d['EFDETOT__All'] > 0;\n  var c2 = d['OPENPUBL'] == 'Institution is open to the public';\n  var c3 = d['DEGGRANT'] == 'Degree-granting';\n  return (c1 && c2 && c3);\n}"
}
