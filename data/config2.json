{
  "cleans": [
    {
      "name": "state",
      "func": "function clean(d) {\n    return  d['STABBR'] || 0\n}",
      "editLink": "<button cid='state' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='state' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "control",
      "func": "function clean(d) {\n    return  d['CONTROL'] || 0\n}",
      "editLink": "<button cid='control' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='control' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "instsize",
      "func": "function clean(d) {\n    return  d['INSTSIZE'] || 0\n}",
      "editLink": "<button cid='instsize' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='instsize' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "iclevel",
      "func": "function clean(d) {\n    return  d['ICLEVEL'] || 0\n}",
      "editLink": "<button cid='iclevel' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='iclevel' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "year",
      "func": "function clean(d) {\n    return  d['YEAR'] || 0\n}",
      "editLink": "<button cid='year' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='year' class='cleanRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "enrolled",
      "func": "function clean(d) {\n    return  d['EFDETOT__All'] || 0\n}",
      "editLink": "<button cid='enrolled' class='cleanEditButton' role='button'>Edit</button>",
      "removeLink": "<button cid='enrolled' class='cleanRemoveButton' role='button'>Remove</button>"
    }
  ],
  "dims": [
    {
      "name": "controlDim",
      "func": "function getDim(d) {\n    return d['control'];\n}",
      "editLink": "<button did='controlDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='controlDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "levelDim",
      "func": "function getDim(d) {\n    return d['iclevel'];\n}",
      "editLink": "<button did='levelDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='levelDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "sizeDim",
      "func": "function getDim(d) {\n    return d['instsize'];\n}",
      "editLink": "<button did='sizeDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='sizeDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "stateDim",
      "func": "function getDim(d) {\n    return d['state'];\n}",
      "editLink": "<button did='stateDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='stateDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "yearDim",
      "func": "function getDim(d) {\n    return d['year'];\n}",
      "editLink": "<button did='yearDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='yearDim' class='dimRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "noDim",
      "func": "function getDim(d) {\n    return 1;\n}",
      "editLink": "<button did='noDim' class='dimEditButton' role='button'>Edit</button>",
      "removeLink": "<button did='noDim' class='dimRemoveButton' role='button'>Remove</button>"
    }
  ],
  "grps": [
    {
      "name": "count",
      "func": "function getGrp(d) {\n    return d['columnName'];\n}",
      "aggs": [
        "count"
      ],
      "editLink": "<button gid='count' class='groupEditButton' role='button'>Edit</button>",
      "removeLink": "<button gid='count' class='groupRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "enrolled",
      "func": "function getGrp(d) {\n    return +d['enrolled'];\n}",
      "aggs": [
        "count",
        "sum",
        "avg"
      ],
      "editLink": "<button gid='enrolled' class='groupEditButton' role='button'>Edit</button>",
      "removeLink": "<button gid='enrolled' class='groupRemoveButton' role='button'>Remove</button>"
    },
    {
      "name": "test",
      "func": "function getGrp(d) {\n    return d['columnName'];\n}",
      "aggs": [
        "test"
      ],
      "editLink": "<button gid='test' class='groupEditButton' role='button'>Edit</button>",
      "removeLink": "<button gid='test' class='groupRemoveButton' role='button'>Remove</button>"
    }
  ],
  "charts": [
    {
      "name": "controlSelector",
      "dim": "controlDim",
      "grp": "count",
      "chartType": "cboxMenu",
      "width": "3",
      "height": "",
      "heading": "",
      "options": {
        "controlsUseVisibility": "",
        "multiple": "",
        "valueAccessor": "function (d) { return d.value.count }",
        "keyAccessor": "function (d) { return d.key }"
      }
    },
    {
      "name": "sizeSelector",
      "dim": "sizeDim",
      "grp": "count",
      "chartType": "cboxMenu",
      "width": "3",
      "height": "",
      "heading": "",
      "options": {
        "controlsUseVisibility": "",
        "multiple": "",
        "valueAccessor": "function (d) { return d.value.count }",
        "keyAccessor": "function (d) { return d.key }"
      }
    },
    {
      "name": "levelSelector",
      "dim": "levelDim",
      "grp": "count",
      "chartType": "cboxMenu",
      "width": "3",
      "height": "",
      "heading": "",
      "options": {
        "controlsUseVisibility": "",
        "multiple": "",
        "valueAccessor": "function (d) { return d.value.count }",
        "keyAccessor": "function (d) { return d.key }"
      }
    },
    {
      "name": "enrolledOverTime",
      "dim": "yearDim",
      "grp": "enrolled",
      "chartType": "barChart",
      "width": "4",
      "height": "200",
      "heading": "Enrolled Students over Time",
      "options": {
        "centerBar": "true",
        "xAxis": {
          "ticks": "5",
          "tickFormat": "d3.format('.4')"
        },
        "x": "d3.scaleLinear().domain([2011,2018])",
        "valueAccessor": "function (d) { return d.value.sum }",
        "keyAccessor": "function (d) { return d.key }",
        "elasticY": "1",
        "yAxis": {
          "tickFormat": "d3.format('.2s')",
          "ticks": "3"
        }
      }
    },
    {
      "name": "enrolledOverTime2",
      "dim": "yearDim",
      "grp": "enrolled",
      "chartType": "barChart",
      "width": "4",
      "height": "200",
      "heading": "Difference of Enrolled Students from year to year",
      "options": {
        "centerBar": "true",
        "xAxis": {
          "ticks": "5",
          "tickFormat": "d3.format('.4')"
        },
        "x": "d3.scaleLinear().domain([2011,2018])",
        "valueAccessor": "function (d) { \n    var _year = d.key\n    if (+_year > 2012) {\n        var prev_value = grp\n           .all()\n           .filter(function(d) { \n               return d.key == (+_year-1).toString() \n           })[0].value.sum\n           \n        return d.value.sum - prev_value           \n    } else {\n        return 0;\n    }\n    //return d.value.sum \n    \n}",
        "keyAccessor": "function (d) { return d.key }",
        "elasticY": "1",
        "yAxis": {
          "tickFormat": "d3.format('.2s')",
          "ticks": "3"
        }
      }
    },
    {
      "name": "enrolledOverTime3",
      "dim": "yearDim",
      "grp": "enrolled",
      "chartType": "barChart",
      "width": "6",
      "height": "200",
      "heading": "Percent Difference of Enrolled Students from year to year",
      "options": {
        "centerBar": "true",
        "xAxis": {
          "ticks": "5",
          "tickFormat": "d3.format('.4')"
        },
        "x": "d3.scaleLinear().domain([2011,2018])",
        "valueAccessor": "function (d) { \n    var _year = d.key\n    if (+_year > 2012) {\n        var prev_value = grp\n           .all()\n           .filter(function(d) { \n               return d.key == (+_year-1).toString() \n           })[0].value.sum;\n        \n        return (d.value.sum - prev_value) / d.value.sum\n\n    } else {\n        return 0\n    }\n    //return d.value.sum \n}",
        "keyAccessor": "function (d) { return d.key }",
        "elasticY": "1",
        "yAxis": {
          "tickFormat": "d3.format('+.1%')",
          "ticks": "3"
        }
      }
    }
  ],
  "style": "",
  "filter": "function (d) {\n  var c1 = +d['EFDETOT__All'] > 0;\n  var c2 = d['OPENPUBL'] == 'Institution is open to the public';\n  var c3 = d['DEGGRANT'] == 'Degree-granting';\n  return (c1 && c2 && c3);\n}"
}
